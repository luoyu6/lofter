<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_872638_mzp0u86cmb.css" />
		<!-- 配置文件 -->
		<script type="text/javascript" charset="utf-8" src="js/plugins/ueditor.config.js"></script>
		<script type="text/javascript" charset="utf-8" src="js/plugins/editor_api.js">
		</script>

		<title></title>
	</head>

	<body>
		<header class="lf_header">
			<div class="container clearfix">
				<div class="logo fl"><img src="img/logo.png" /></div>
				<div class="navbar fl">
					<ul class="fl">
						<li>
							<a href="javascript:;">首页</a>
						</li>
						<li>
							<a href="javascript:;">浏览 APP</a>
						</li>
						<li>
							<a href="javascript:;">话题 </a>
						</li>
						<li>
							<a href="javascript:;">达人</a>
						</li>
						<li>
							<a href="javascript:;">设置</a>
						</li>
						<li>
							<a href="javascript:;">更多</a>
						</li>
					</ul>
					<div class="search fl">
						<input type="" name="" id="" value="" placeholder="搜索用户、标签" />
						<i class="iconfont icon-sousuo"></i>
						<span class="new">new</span>
					</div>
				</div>
			</div>
		</header>
		<section class="lf_content container">
			<div class="content_left fl">
				<div class="select_bar">
					<ul>
						<li class="user">
							<a href="javascript:;"></a>
						</li>
						<li class="text">
							<a href="javascript:;"></a>

						</li>
						<li class="camera">
							<a href="javascript:;"></a>

						</li>
						<li class="music">
							<a href="javascript:;"></a>

						</li>
						<li class="video">
							<a href="javascript:;"></a>

						</li>
						<li class="article">
							<a href="javascript:;"></a>

						</li>
					</ul>
				</div>
				<div id="content" class="content">
					<div id="dialog_content">
						<div class="dia_logo fl">
							<a href="javascript:;"><img src="img/64.png" /></a>
						</div>
						<div class="dia_content fr">
							<h3>一天到晚游泳的鱼</h3>
							<div class="edit_wraper">
								<input type="" name="" id="artile_title" value="" placeholder="标题（可不填）" />
								<div id="" style="width: 100%;margin: 0 auto;">
									<script id="editor" type="text/plain" style="width:100%;height:190px; border-bottom: 1px solid #e0e0e0"></script>

								</div>
								<div class="hot_tag">
									<span></span>
									<input type="" name="" id="tag" value="" placeholder="添加相关标签，用逗号或回车分隔" style="    border-bottom: 1px solid #e0e0e0;" />

								</div>
								<div class="add_to">
									<input type="" name="" id="collect" value="" placeholder="加入集合" style="    border-bottom: 1px solid #e0e0e0;" />
								</div>

							</div>
							<div class="sel_wraper">
								<p class="check">
									<input type="checkbox" name="" id="" value="" />
									<lable>允许他人转载至LOFTER</lable>
								</p>
								<p class="sel">
									<lable>授权方式</lable>
									<select name="">
										<option value="">不使用原创授权</option>
										<option value="">使用原创授权</option>
										<option value="">不使用原创授权</option>
										<option value="">使用原创授权</option>
									</select>
								</p>
							</div>
							<div class="btn_box clearfix">

								<a href="javascript:;" class="sel_btn fr"><span class="sel"></span></a>
								<a href="javascript:;" id="submit" class="submit_btn fr">发布</a>

								<a href="javascript:;" id="quit" class="quit fl">取消</a>

							</div>

						</div>
					</div>

					<div class="clearfix">
						<div class="appdownloadbanner fr">
							<a href="https://luoyu6.github.io/demo/index.html">
								<img src="img/dlbanner.jpg" />
								<span id="close">
								
							</span>
							</a>
						</div>
					</div>
					<div class="article_list">
						<ul>

							<li class="item clearfix">
								<div class="content_show_wrapper clearfix">
									<div class="userimg fl"><img src="img/uer1.jpg" /></div>
									<div class="article_content fr">
										<div class="item_icon"></div>
										<div class="item_content">
											<p class="username">
												<a href="javascript:;">慢食堂</a>转载自
												<a href="javascript:;">亦荷yihe</a>
											</p>
											<h3 class="article_title">网红小食轻松get</h3>
											<div class="content_wrapper">
												<div class="clearfix">
													<img src="img/T0.jpg" width="164" height="116" class="fl" />
													<p class="text">紫苏饭团<br>配料:米饭250克，紫苏8克，鸡蛋1个，梅子酱1勺，饭团模具1个。<br>1:新蒸熟米饭250克趁热和紫苏调料拌匀。<br>2:&nbsp;鸡蛋打散，平底锅煎熟铲碎。<br>3:煎好的鸡蛋碎和一勺梅子酱拌匀。<br>4:&nbsp;去一个饭团模具，先铺上一层紫苏米饭，中心放上鸡蛋碎。<br>5:&nbsp;上面一层再盖上一层米饭，铺平。<br>6:&nbsp;盖上模具盖子，压实。<br>7备注:每做一个饭团，可在&nbsp;模具上涂一些白开水防粘。&nbsp;
														<a target="_blank" href="javascript:;">@慢食堂</a>&nbsp;&nbsp;
														<a target="_blank" href="javascript:;">@美食精选</a>&nbsp;
													</p>
												</div>
												<div class="tag clearfix">
													<i class="tag_icon fl"></i>
													<span class="fl">365天早餐不重样</span>
													<div class="fr tag_fr">
														<span class="fl">热度(141)</span><span class="fl comment">评论(8)</span><span class="fl">分享</span><span class="fl">推荐</span><span class="fl love"><i class="icon-hongxin1 iconfont"></i></span>

													</div>
												</div>
											</div>
										</div>

									</div>
									<a href="javascript:;" class="icon_right"></a>
									<a href="javascript:;" class="icon_left"></a>
								</div>
								<div class="content_hide_wrapper fr">
									<div class="hot"></div>
									<div class="comment">
										<p class="clearfix">
											<input type="" name="" id="" value="" class="com_input" />
											<a href="javascript:;" class="com_btn">发布</a>

										</p>
										<ul class="com_detail">
											<li><img src="img/comm0.jpg" /><span class="username">草莓♡果酱</span><span class="text">感觉教了也不会，会了一做就废</span></li>
											<li><img src="img/comm1.jpg" /><span class="username">au_fond_de_moi</span><span class="text">看着就好香啊</span></li>
											<li><img src="img/comm2.jpg" /><span class="username">小绵羊</span class="text">看着都有点饿哎</li>
										</ul>
									</div>
									<div class="share"></div>
								</div>
							</li>

							<li class="item clearfix">
								<div class="content_show_wrapper clearfix">
								
								<div class="userimg fl"><img src="img/uer2.jpg" /></div>
								<div class="article_content fr">
									<div class="item_icon"></div>
									<div class="item_content">
										<p class="username">
											<a href="javascript:;">一边看一边走 || 老土豹的行摄记</a>
										</p>
										<h3 class="article_title">【带着吾儿去旅行】看不尽的碧海丹霞 · 苏梅岛 II</h3>
										<div class="content_wrapper">
											<img src="img/PT0.jpg" width="164" height="116" class="fl" />
											<p class="text">从比翼双飞的模式毕业，从此多了个小拖油瓶。带着娃旅行自然受限，不过虽然没玩成四轮越野，也没能扬帆出海去周边那几个漂亮离岛潜水，天天陪着儿子混吃混喝吃饱睡觉也蛮开心。</br>
												我记得抱着你在天蒙蒙亮时看见几个僧侣从沙滩上走过，大口呼吸别人不曾感受的海风；也记得太阳下落后沙滩上那挖沙子的小小身影和远方归来的渔船组成一幅不需修饰就能感受到满满幸福的简单画面。对于这片海，说了再见后只有怀念，因为，这里记载了吾儿最真实的模样。

											</p>
											<div class="tag clearfix">
												<i class="tag_icon fl"></i>
												<span class="fl">拍出电影感</span>
												<div class="fr tag_fr">
													<span class="fl">热度(534)</span><span class="fl comment">评论(13)</span><span class="fl">分享</span><span class="fl">推荐</span><span class="fl love"><i class="icon-hongxin1 iconfont"></i></span>
												</div>
									</div>
								</div>
					</div>

				</div>
				<a href="javascript:;" class="icon_right"></a>
				<a href="javascript:;" class="icon_left"></a>
			</div>
			<div class="content_hide_wrapper fr">
				<div class="hot"></div>
				<div class="comment">
					<p class="clearfix">
						<input type="" name="" id="" value="" class="com_input">
						<a href="javascript:;" class="com_btn">发布</a>

					</p>
					<ul class="com_detail">
						<li class="clearfix">
							<img src="img/luoyu.png" class="fl">
							<div class="comment_div fl">
								<span class="username">一天到游泳的鱼</span><span class="text">城市的精神寄托。故事中的小美人鱼，优雅善良带着忧伤，我印象中的哥本哈根，善良优雅，却非常快乐。时光流远，走过黑暗和绝望，唯有幸福在此沉淀。    很多照片在一篇文章里放不下，等奥尔胡斯和赫尔辛格写完，还会再补一篇丹麦拾遗。感谢大家的关注和喜欢！</span>
							</div>
						</li>

						<li class="clearfix"><img src="img/comm0.jpg" class="fl">
							<div class="comment_div fl">
								<span class="username">草莓♡果酱</span><span class="text">感觉教了也不会，会了一做就废</span>
							</div>
						</li>
						<li class="clearfix"><img src="img/comm1.jpg" class="fl">
							<div class="comment_div fl"><span class="username">au_fond_de_moi</span><span class="text">看着就好香啊</span></div>
						</li>
						<li class="clearfix"><img src="img/comm2.jpg" class="fl">
							<div class="comment_div fl"><span class="username">小绵羊</span><span class="text">看着都有点饿哎</span></div>
						</li>
					</ul>
				</div>
				<div class="share"></div>
			</div>

			</li>
			</ul>
			</div>
			</div>
			</div>
			<div class="sidebar_right fr"></div>
		</section>
		<div class="dialog">

		</div>

	</body>
	<script src="js/jquery.js"></script>

	<script type="text/javascript">
		//去掉空格
		function deleteSpace(str) {
			var newstr = str.replace(/\s+/g, ""); //去掉空格		
			return newstr;
		}
		//去掉空格

		//创建一条新的评论 start
		function createCommentElement(comment_text) {

			var $li = document.createElement('li');
			var $img = document.createElement('img');
			var $username = document.createElement('span');
			var $text = document.createElement('span');
			$username.className = 'username';
			$text.className = 'text';
			$li.appendChild($img);
			$li.appendChild($username);
			$li.appendChild($text);
			$img.src = "img/luoyu.png"
			$username.innerHTML = "一天到游泳的鱼";
			$text.innerHTML = comment_text;
			return $li;
		}
		//创建一条新的评论 end
		//收藏
		var b = false;
		$('.love>i').click(function() {
			if(!b) {
				$(this).addClass('i_col');
				b = true;
			} else {
				$(this).removeClass('i_col');
				b = false;
			}
		})
		//收藏

		//点击发布，新增一个动态,所有的操作都要在新增动态（追加元素）完成之后   start------------------------------------------------------------------------------------------
		$('#submit').click(function() {
			var $ul = document.getElementsByClassName('article_list')[0].getElementsByTagName('ul')[0]; //获取ul
			var $li = $ul.getElementsByClassName('item')[0]; //获取ul的第一个li

			var article_content = UE.getEditor('editor').getPlainTxt() //正文内容
			var article_title = $('#artile_title').val(); //文章标题
			var article_tag = $('#tag').val(); //文章标签
			var str = article_content.replace(/\s+/g, ""); //去掉空格		
			if(str.length > 0) {
				var new_item = create(article_title, article_content, article_tag); //返回的字符串	
				$($ul).prepend(new_item);

				//给新的元素绑定事件 start
				$(".edit").on('click', function() {
					edit($(this));
				});
				$('.tag_fr .del').on('click', function() {
					del($(this));

				});
				$('.tag_fr .comment').on('click', function() {
					showComment($(this));
				});
				$('.comment .com_btn').on('click', function() {
					comment($(this));
				});
				//给新的元素绑定事件 end
				
				
				//存储数据
				save(new_item);

			} else {
				alert('请输入日志内容！');
				return false;
			}

			//			$ul.appendChild(new_item);
			$('#dialog_content').hide();
			$('.dialog').hide();
			$('.select_bar').show();

		});
		//点击发布，新增一个动态,所有的操作都要在新增动态（追加元素）完成之后     end---------------------------------------------------------------------------------------------

		//保存内容
		function save(item) {
			localStorage.setItem(item, item);

		}
		showList();
		//显示添加过的内容 start
		function showList() {
			var $ul = document.getElementsByClassName('article_list')[0].getElementsByTagName('ul')[0]; //获取ul
			for(var i = 0; i < localStorage.length; i++) {
				var keys = localStorage.key(i);
				var html = localStorage.getItem(keys);
				if(keys != 'ueditor_preference') { //ueidtor会默认将文本内容保存起来，坑爹的一个功能，需要将ueidtor保存的内容过滤掉，才能追加内容
					$($ul).prepend(html);

				}

			}
		}
		//显示添加过的内容 end

		//编辑内容
		//原有的元素调用方法
		$('.edit').click(function() {
			edit($(this));
		});

		function edit(obj) {
			var title = obj.parents('.item_content ').find('.article_title').text();
			var txt = obj.parents('.item_content ').find('.content_wrapper .text').text();
			var tag = obj.parents('.item_content ').find('.tag>span').text();
			$('#artile_title').val(title);
			var ue = UE.getEditor('editor');
			ue.setContent(txt);
			$('#tag').val(tag);

			$('.select_bar').fadeOut();
			$('.dialog').show();
			$('#dialog_content').show();
			obj.parents('.item  ').remove();

		}
		//编辑内容 end

		//删除当前动态 start
		function del(obj) {
			obj.parents('.item').remove();
		}
		$('.tag_fr .del').click(function() {
			del($(this));

		});
		//删除当前动态 end
		//点击评论显示评论 start
		var b = false;
		$('.tag_fr span.comment').click(function() {
			showComment($(this));
		})

		function showComment(obj) {
			if(!b) {
				//$(this).parents('.content_show_wrapper ').siblings('.content_hide_wrapper ').show().find('.comment').show().siblings().hide();
				obj.parents('.item').find('.content_show_wrapper ').siblings('.content_hide_wrapper ').stop(true, true).slideDown().find('.comment').show().siblings().hide();
				b = true;
			} else {
				obj.parents('.item').find('.content_show_wrapper ').siblings('.content_hide_wrapper ').stop(true, true).slideUp().find('.comment').show().siblings().hide();
				b = false;
			}
			console.log(b)
		}

		//点击评论显示评论 end

		//点击按钮发表评论 strat

		$('.comment .com_btn').click(function() {
			comment($(this));
		});

		function comment(obj) {
			var $comment_val = obj.prev().val();
			var len = deleteSpace($comment_val).length;
			if(len) {
				var comment_li = createCommentElement($comment_val);
				obj.parents('.comment').find('.com_detail').prepend(comment_li); //给当前的动态添加评论
				var i = Math.floor(Math.random(50));
				//				localStorage.setItem(i, comment_li);
				console.log(i);

			} else {
				alert(' 请输入评论内容');
				return false;
			}
		}
		//点击按钮发表评论 end

		//点击取消，弹窗关闭
		$('#quit').click(function() {
			$(this).parents('#dialog_content').hide();
			$('.dialog').hide();
			$('.select_bar').show();
		})

		var ue = UE.getEditor('editor');
		$('#close').click(function(e) {
			e.preventDefault();
			$('.appdownloadbanner ').slideUp('fast');
		});
		$('.select_bar li').click(function() {
			//			alert(1)
			$(this).parents('.select_bar').fadeOut();
			$('.dialog').show();
			$('#dialog_content').show()
		});

		function create(title, txt, tag) {

			var html =

				'<li class="item clearfix">' +
				'<div class="content_show_wrapper clearfix">' +
				'<div class="userimg fl"><img src="img/uer0.jpg" /></div>' +
				'<div class="article_content fr">' +
				'<div class="item_icon"></div>' +
				'<div class="item_content">' +
				'<p class="username">' +
				'<a href="javascript:;">一天到游泳的鱼 </a>' +
				'</p>' +
				'<h3 class="article_title">' + title + '</h3>' +
				'<div class="content_wrapper">' +
				'<div class="clearfix">' +
				'<img src="img/uer2-articleimg.jpg" width="164" height="116" class="fl" />' +
				'<p class="text">' + txt +
				'</p>' +
				'</div>' +
				'<div class="tag clearfix">' +
				'<i class="tag_icon fl"></i>' +
				'<span class="fl">' + tag + '</span>' +
				'<div class="fr tag_fr">' +
				'<span class="fl edit" >编辑</span><span class="fl del">删除</span><span class="fl comment" >评论</span><span class="fl share">分享</span>' +
				'</div>' +
				'</div>' +
				'</div>' +
				'</div>' +
				'</div>' +
				'<a href="javascript:;" class="icon_right"></a>' +
				'<a href="javascript:;" class="icon_left"></a>' +
				'</div>' +
				"<div class='content_hide_wrapper fr'>" +
				"									<div class='hot'></div>" +
				"									<div class='comment'>" +
				"										<p class='clearfix'>" +
				"											<input type='' name='' id='' value='' class='com_input'>" +
				"											<a href='javascript:;' class='com_btn'>发布</a></p>" +
				"										<ul class='com_detail'>" +
				"										</ul>" +
				"									</div>" +
				"									<div class='share'></div>" +
				"								</div>" +
				'</li>';

			return html;

		}
	</script>

</html>